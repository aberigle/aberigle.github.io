/*
  app v0.3.1 - 19/5/2015

  Author: aberigle - a.berzosa.iglesias@gmail.com
*/
(function(){var a,b,c,d,e=function(a,b){function c(){this.constructor=a}for(var d in b)f.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},f={}.hasOwnProperty;console.log("Hay there, you can find me @aberigle"),window.isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)},a=function(){function a(a){this.path=a}return a.prototype.path="",a.prototype.execute=function(a,b,c,d){var e;return null==a&&(a={}),e=new XMLHttpRequest,e.onreadystatechange=function(a){return 4===e.readyState&&"function"==typeof d?d(a.target):void 0},e.open(c,this.path+b,!0),"POST"===c||"PUT"===c||"PATCH"===c?e.send(JSON.stringify(a)):e.send()},a.prototype._get=function(a,b){return this.execute(null,a,"GET",b)},a.prototype._post=function(a,b,c){return this.execute(a,b,"POST",c)},a.prototype._put=function(a,b,c){return this.execute(a,b,"PUT",c)},a.prototype._del=function(a,b){return this.execute(null,a,"DELETE",b)},a}(),b=function(a){function b(){b.__super__.constructor.call(this,"http://image-a-day.herokuapp.com/")}return e(b,a),b.prototype.getImage=function(a){return this._get("/image",function(b){return"function"==typeof a?a(JSON.parse(b.response)):void 0})},b}(a),c=function(a){function b(a){var c;c="http://ws.audioscrobbler.com/2.0/?format=json",c+="&api_key="+a,b.__super__.constructor.call(this,c)}var c;return e(b,a),c=function(a){var b,c;c="";for(b in a)c+="&"+b+"="+a[b];return c},b.prototype.getNowPlaying=function(a,b){var d;return d=c({method:"user.getrecenttracks",user:a,limit:1}),this._get(d,function(a){return a=JSON.parse(a.response).recenttracks,null!=a.track&&isArray(a.track)?"function"==typeof b?b(a.track[0]):void 0:"function"==typeof b?b():void 0})},b}(a),window.aberigle=d={},d.api={image:new b,lastfm:new c("9ad1ebab368b74b48c4fbd6cf095087e")},window.onload=function(){var a,b;return copyright.onmouseenter=function(){return document.body.classList.add("clean")},copyright.onmouseleave=function(){return document.body.classList.remove("clean")},b=function(a){var b,c,d,e;return null==a?!1:(e=copyright.children[1],e.text=a.name+" - "+a.artist["#text"],e.href="http://www.last.fm/user/Jayle23",c=a.image[a.image.length-1]["#text"],""===c?!1:(background.style.backgroundImage="url("+c+")",b=copyright.children[0],b.src="./static/images/equalizer.gif",d=window.lastfm.children[0],d.firstChild.src=c,d.children[1].innerText=a.name+"\n"+a.artist["#text"],document.body.classList.add("lastfm"),!0))},a=function(a){var b;return background.style.backgroundImage="url("+a.imageUrl+")",b=copyright.children[1],b.href=a.copyrightLink,b.text=a.copyright},d.api.lastfm.getNowPlaying("jayle23",function(c){return b(c)?void 0:d.api.image.getImage(a)})}}).call(this);